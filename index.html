<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Science 8 - Natural History Study Guide</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Instrument+Serif:ital@0;1&family=DM+Sans:opsz,wght@9..40,300;9..40,400;9..40,500;9..40,600&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0d1117;
            --bg-secondary: #161b22;
            --bg-card: #1c2128;
            --bg-card-hover: #252d38;
            --accent-teal: #58d5c9;
            --accent-coral: #ff7b72;
            --accent-amber: #f0b866;
            --accent-lavender: #a5a6f6;
            --text-primary: #f0f6fc;
            --text-secondary: #8b949e;
            --text-muted: #6e7681;
            --border: #30363d;
            --success: #3fb950;
            --error: #f85149;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'DM Sans', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
        }

        .noise-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            opacity: 0.03;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
            z-index: 1000;
        }

        .gradient-orb {
            position: fixed;
            border-radius: 50%;
            filter: blur(80px);
            opacity: 0.15;
            pointer-events: none;
            z-index: -1;
        }

        .orb-1 {
            width: 600px;
            height: 600px;
            background: var(--accent-teal);
            top: -200px;
            right: -100px;
        }

        .orb-2 {
            width: 400px;
            height: 400px;
            background: var(--accent-coral);
            bottom: -100px;
            left: -100px;
        }

        .container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 2rem;
        }

        header {
            text-align: center;
            padding: 3rem 0 4rem;
            position: relative;
        }

        .badge {
            display: inline-block;
            background: linear-gradient(135deg, var(--accent-teal), var(--accent-lavender));
            color: var(--bg-primary);
            padding: 0.4rem 1rem;
            border-radius: 50px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 1.5rem;
        }

        h1 {
            font-family: 'Instrument Serif', serif;
            font-size: clamp(2.5rem, 6vw, 4rem);
            font-weight: 400;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--accent-teal) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            color: var(--text-secondary);
            font-size: 1.1rem;
            margin-bottom: 2rem;
        }

        .quizlet-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--accent-amber);
            text-decoration: none;
            font-size: 0.9rem;
            padding: 0.6rem 1.2rem;
            border: 1px solid var(--accent-amber);
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .quizlet-link:hover {
            background: var(--accent-amber);
            color: var(--bg-primary);
        }

        nav {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin-bottom: 3rem;
            flex-wrap: wrap;
        }

        .nav-btn {
            padding: 0.8rem 1.5rem;
            border: none;
            background: var(--bg-secondary);
            color: var(--text-secondary);
            font-family: inherit;
            font-size: 0.95rem;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid var(--border);
        }

        .nav-btn:hover {
            background: var(--bg-card);
            color: var(--text-primary);
            border-color: var(--text-muted);
        }

        .nav-btn.active {
            background: var(--accent-teal);
            color: var(--bg-primary);
            border-color: var(--accent-teal);
            font-weight: 500;
        }

        /* Study Mode */
        #study-mode {
            display: block;
        }

        .flashcard-container {
            perspective: 1000px;
            margin-bottom: 2rem;
        }

        .flashcard {
            width: 100%;
            min-height: 320px;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
        }

        .flashcard.flipped {
            transform: rotateY(180deg);
        }

        .flashcard-face {
            position: absolute;
            width: 100%;
            min-height: 320px;
            backface-visibility: hidden;
            border-radius: 20px;
            padding: 2.5rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        .flashcard-front {
            background: linear-gradient(145deg, var(--bg-card) 0%, var(--bg-secondary) 100%);
            border: 1px solid var(--border);
        }

        .flashcard-back {
            background: linear-gradient(145deg, #1a2332 0%, var(--bg-card) 100%);
            border: 1px solid var(--accent-teal);
            transform: rotateY(180deg);
        }

        .card-label {
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            color: var(--text-muted);
            margin-bottom: 1.5rem;
        }

        .flashcard-front .card-label {
            color: var(--accent-coral);
        }

        .flashcard-back .card-label {
            color: var(--accent-teal);
        }

        .card-content {
            font-family: 'Instrument Serif', serif;
            font-size: clamp(1.2rem, 3vw, 1.6rem);
            line-height: 1.5;
            color: var(--text-primary);
        }

        .click-hint {
            position: absolute;
            bottom: 1.5rem;
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .card-controls {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .control-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: 1px solid var(--border);
            background: var(--bg-secondary);
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .control-btn:hover {
            border-color: var(--accent-teal);
            background: var(--bg-card);
            transform: scale(1.05);
        }

        .control-btn svg {
            width: 24px;
            height: 24px;
        }

        .progress-info {
            text-align: center;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .progress-bar {
            width: 100%;
            height: 4px;
            background: var(--bg-secondary);
            border-radius: 2px;
            margin-top: 1rem;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-teal), var(--accent-lavender));
            border-radius: 2px;
            transition: width 0.3s ease;
        }

        /* Quiz Mode */
        #quiz-mode {
            display: none;
        }

        .quiz-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding: 1rem 1.5rem;
            background: var(--bg-secondary);
            border-radius: 12px;
            border: 1px solid var(--border);
        }

        .quiz-progress {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .quiz-score {
            display: flex;
            gap: 1.5rem;
        }

        .score-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
        }

        .score-correct {
            color: var(--success);
        }

        .score-wrong {
            color: var(--error);
        }

        .ai-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.8rem;
            color: var(--text-muted);
            padding: 0.4rem 0.8rem;
            background: var(--bg-card);
            border-radius: 20px;
            border: 1px solid var(--border);
        }

        .ai-indicator.active {
            color: var(--accent-teal);
            border-color: var(--accent-teal);
        }

        .ai-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--text-muted);
        }

        .ai-indicator.active .ai-dot {
            background: var(--accent-teal);
            box-shadow: 0 0 8px var(--accent-teal);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.5;
            }
        }

        .quiz-question {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 2.5rem;
            margin-bottom: 1.5rem;
        }

        .quiz-question h3 {
            font-family: 'Instrument Serif', serif;
            font-size: 1.4rem;
            font-weight: 400;
            margin-bottom: 0.5rem;
            color: var(--accent-amber);
        }

        .quiz-question p {
            font-size: 1.1rem;
            line-height: 1.6;
        }

        .quiz-input {
            width: 100%;
            padding: 1rem 1.5rem;
            font-family: inherit;
            font-size: 1rem;
            background: var(--bg-secondary);
            border: 2px solid var(--border);
            border-radius: 12px;
            color: var(--text-primary);
            margin-bottom: 1rem;
            transition: border-color 0.3s ease;
        }

        .quiz-input:focus {
            outline: none;
            border-color: var(--accent-teal);
        }

        .quiz-input::placeholder {
            color: var(--text-muted);
        }

        .quiz-actions {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .quiz-btn {
            flex: 1;
            min-width: 150px;
            padding: 1rem 2rem;
            border: none;
            border-radius: 12px;
            font-family: inherit;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .quiz-btn-primary {
            background: var(--accent-teal);
            color: var(--bg-primary);
        }

        .quiz-btn-primary:hover {
            filter: brightness(1.1);
            transform: translateY(-2px);
        }

        .quiz-btn-secondary {
            background: var(--bg-secondary);
            color: var(--text-primary);
            border: 1px solid var(--border);
        }

        .quiz-btn-secondary:hover {
            border-color: var(--text-muted);
        }

        .feedback {
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 1.5rem;
            display: none;
        }

        .feedback.correct {
            display: block;
            background: rgba(63, 185, 80, 0.1);
            border: 1px solid var(--success);
        }

        .feedback.wrong {
            display: block;
            background: rgba(248, 81, 73, 0.1);
            border: 1px solid var(--error);
        }

        .feedback-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .feedback.correct .feedback-title {
            color: var(--success);
        }

        .feedback.wrong .feedback-title {
            color: var(--error);
        }

        .correct-answer {
            margin-top: 0.5rem;
            padding: 1rem;
            background: var(--bg-secondary);
            border-radius: 8px;
            font-size: 0.95rem;
            line-height: 1.5;
        }

        /* Browse All Mode */
        #browse-mode {
            display: none;
        }

        .card-grid {
            display: grid;
            gap: 1rem;
        }

        .browse-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 1.5rem;
            transition: all 0.3s ease;
        }

        .browse-card:hover {
            border-color: var(--accent-teal);
            transform: translateY(-2px);
        }

        .browse-question {
            font-weight: 500;
            color: var(--accent-coral);
            margin-bottom: 0.75rem;
            font-size: 0.95rem;
        }

        .browse-answer {
            color: var(--text-secondary);
            font-size: 0.9rem;
            line-height: 1.6;
        }

        .card-number {
            display: inline-block;
            background: var(--bg-secondary);
            color: var(--text-muted);
            font-size: 0.7rem;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            margin-bottom: 0.75rem;
        }

        /* Quiz Complete */
        .quiz-complete {
            text-align: center;
            padding: 3rem;
            display: none;
        }

        .quiz-complete.show {
            display: block;
        }

        .complete-icon {
            font-size: 4rem;
            margin-bottom: 1.5rem;
        }

        .complete-title {
            font-family: 'Instrument Serif', serif;
            font-size: 2rem;
            margin-bottom: 1rem;
        }

        .complete-stats {
            display: flex;
            justify-content: center;
            gap: 3rem;
            margin: 2rem 0;
        }

        .stat {
            text-align: center;
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 600;
            color: var(--accent-teal);
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* Keyboard Hints */
        .keyboard-hints {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-top: 2rem;
            flex-wrap: wrap;
        }

        .hint {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        kbd {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 4px;
            padding: 0.2rem 0.5rem;
            font-family: inherit;
            font-size: 0.75rem;
        }

        @media (max-width: 600px) {
            .container {
                padding: 1rem;
            }

            header {
                padding: 2rem 0 3rem;
            }

            .flashcard-face {
                padding: 1.5rem;
            }

            .quiz-header {
                flex-direction: column;
                gap: 1rem;
            }

            .complete-stats {
                flex-direction: column;
                gap: 1.5rem;
            }

            .keyboard-hints {
                display: none;
            }
        }
    </style>
</head>

<body>
    <div class="noise-overlay"></div>
    <div class="gradient-orb orb-1"></div>
    <div class="gradient-orb orb-2"></div>

    <div class="container">
        <header>
            <div class="badge">Science 8 ‚Ä¢ Test 2</div>
            <h1>Natural History</h1>
            <p class="subtitle">Study Guide &amp; Interactive Quiz</p>
            <a href="https://quizlet.com/1118236469/science-8-test-2-flash-cards/" target="_blank" rel="noopener"
                class="quizlet-link">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                    <polyline points="15 3 21 3 21 9"></polyline>
                    <line x1="10" y1="14" x2="21" y2="3"></line>
                </svg>
                View on Quizlet
            </a>
            <!-- <button class="quizlet-link" id="api-key-btn" style="margin-left: 0.5rem; cursor: pointer; background: transparent;">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="3"></circle>
                    <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
                </svg>
                API Key
            </button> -->
        </header>

        <nav>
            <button class="nav-btn active" data-mode="study">Study Cards</button>
            <button class="nav-btn" data-mode="quiz">Quiz Me</button>
            <button class="nav-btn" data-mode="browse">Browse All</button>
            <button class="nav-btn" data-mode="quizlet">Quizlet</button>
        </nav>

        <!-- Study Mode -->
        <section id="study-mode">
            <div class="flashcard-container">
                <div class="flashcard" id="flashcard">
                    <div class="flashcard-face flashcard-front">
                        <span class="card-label">Question</span>
                        <div class="card-content" id="card-question"></div>
                        <span class="click-hint">Click to reveal answer</span>
                    </div>
                    <div class="flashcard-face flashcard-back">
                        <span class="card-label">Answer</span>
                        <div class="card-content" id="card-answer"></div>
                        <span class="click-hint">Click to see question</span>
                    </div>
                </div>
            </div>

            <div class="card-controls">
                <button class="control-btn" id="prev-btn" title="Previous card">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="15 18 9 12 15 6"></polyline>
                    </svg>
                </button>
                <button class="control-btn" id="shuffle-btn" title="Shuffle cards">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="16 3 21 3 21 8"></polyline>
                        <line x1="4" y1="20" x2="21" y2="3"></line>
                        <polyline points="21 16 21 21 16 21"></polyline>
                        <line x1="15" y1="15" x2="21" y2="21"></line>
                        <line x1="4" y1="4" x2="9" y2="9"></line>
                    </svg>
                </button>
                <button class="control-btn" id="next-btn" title="Next card">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="9 18 15 12 9 6"></polyline>
                    </svg>
                </button>
            </div>

            <div class="progress-info">
                <span id="card-progress">1 of 19</span>
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
            </div>

            <div class="keyboard-hints">
                <div class="hint"><kbd>Space</kbd> Flip card</div>
                <div class="hint"><kbd>‚Üê</kbd> Previous</div>
                <div class="hint"><kbd>‚Üí</kbd> Next</div>
            </div>
        </section>

        <!-- Quiz Mode -->
        <section id="quiz-mode">
            <div class="quiz-header">
                <div class="quiz-progress">Question <span id="quiz-current">1</span> of <span id="quiz-total">19</span>
                </div>
                <div class="ai-indicator" id="ai-indicator">
                    <span class="ai-dot"></span>
                    <span id="ai-status">AI Checking</span>
                </div>
                <div class="quiz-score">
                    <div class="score-item score-correct">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <polyline points="20 6 9 17 4 12"></polyline>
                        </svg>
                        <span id="correct-count">0</span>
                    </div>
                    <div class="score-item score-wrong">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                        <span id="wrong-count">0</span>
                    </div>
                </div>
            </div>

            <div id="quiz-content">
                <div class="quiz-question">
                    <h3>Question</h3>
                    <p id="quiz-question-text"></p>
                </div>

                <div class="feedback" id="feedback">
                    <div class="feedback-title" id="feedback-title"></div>
                    <div id="feedback-text"></div>
                    <div class="correct-answer" id="correct-answer-box"></div>
                </div>

                <textarea class="quiz-input" id="quiz-answer" placeholder="Type your answer here..."
                    rows="3"></textarea>

                <div class="quiz-actions">
                    <button class="quiz-btn quiz-btn-secondary" id="show-answer-btn">Show Answer</button>
                    <button class="quiz-btn quiz-btn-primary" id="check-answer-btn">Check Answer</button>
                    <button class="quiz-btn quiz-btn-primary" id="next-question-btn" style="display: none;">Next
                        Question</button>
                </div>
            </div>

            <div class="quiz-complete" id="quiz-complete">
                <div class="complete-icon">üéâ</div>
                <h2 class="complete-title">Quiz Complete!</h2>
                <div class="complete-stats">
                    <div class="stat">
                        <div class="stat-value" id="final-correct">0</div>
                        <div class="stat-label">Correct</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value" id="final-percentage">0%</div>
                        <div class="stat-label">Score</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value" id="final-wrong">0</div>
                        <div class="stat-label">Missed</div>
                    </div>
                </div>
                <button class="quiz-btn quiz-btn-primary" id="restart-quiz-btn">Try Again</button>
            </div>
        </section>

        <!-- Browse Mode -->
        <section id="browse-mode">
            <div class="card-grid" id="card-grid"></div>
        </section>

        <!-- Quizlet Mode -->
        <section id="quizlet-mode" style="display: none;">
            <div class="quizlet-controls"
                style="margin-bottom: 2rem; display: flex; justify-content: center; gap: 0.5rem; flex-wrap: wrap;">
                <button class="nav-btn active" data-quizlet-mode="match">Match</button>
                <button class="nav-btn" data-quizlet-mode="learn">Learn</button>
                <button class="nav-btn" data-quizlet-mode="flashcards">Flashcards</button>
                <button class="nav-btn" data-quizlet-mode="test">Test</button>
                <button class="nav-btn" data-quizlet-mode="spell">Spell</button>
            </div>
            <div class="quizlet-container"
                style="border-radius: 12px; overflow: hidden; border: 1px solid var(--border); background: var(--bg-card);">
                <iframe id="quizlet-iframe" src="https://quizlet.com/1118236469/match/embed?i=6rud4j&x=1jj1"
                    height="500" width="100%" style="border:0"></iframe>
            </div>
        </section>
    </div>

    <script>
        // Flashcard Data
        const flashcards = [
            { q: "What is natural history?", a: "The observational study of plants and animals in their natural habitats over time." },
            { q: "Why is understanding natural history important?", a: "It helps us understand the environment to conserve/better protect it. We can then also make future predictions about the land." },
            { q: "What are two unique land formations in Monterey? How did they form?", a: "Sand Dunes (Formed 10-20,000 years ago, Ocean level fell, cliffs were exposed, erosion happened to form sand) Monterey Bay Canyon (Formed by turbidity currents - similar to an underwater avalanche of sand moved by waves that cross the bay from Santa Cruz)" },
            { q: "In general, what factors affect soil and land formation?", a: "Living organisms, Time (humans), Topography, Parental material, Climate" },
            { q: "What are the layers of soil and how do they function?", a: "Organic matter (animals in soil, decomposing matter) ‚Üí Silt and clay ‚Üí Weathered rock fragment ‚Üí Parent rock. Decomposition goes up these layers." },
            { q: "Why is soil pH important?", a: "It affects nutrient availability for plants." },
            { q: "What is pH?", a: "The concentration of hydrogen ions (H+) in a solution." },
            { q: "What does it mean for something to be acidic in terms of pH?", a: "It has a pH less than 7." },
            { q: "What does it mean for something to be basic in terms of pH?", a: "It has a pH greater than 7." },
            { q: "What is the atomic number?", a: "The number of protons in an atom, which equals the number of electrons." },
            { q: "What is the atomic mass?", a: "The average mass of a typical atom of the given element." },
            { q: "What makes up climate?", a: "Climate refers to the long-term weather patterns of a particular area, typically determined after tracking for 30 years." },
            { q: "What is the definition of climate change?", a: "Climate change refers to long-term shifts in temperatures and weather patterns. Climate change can be naturally occurring or caused by human activity." },
            { q: "What are the causes of the climate changes our world is currently experiencing?", a: "Natural fluctuations in earth's climate have resulted from changes in earth's orbit, variations in the sun's energy, volcanic activity, and changes in ocean patterns. Human activities have included burning fossil fuels which produces CO2 gas. CO2 gasses create a greenhouse effect." },
            { q: "What is the greenhouse effect?", a: "Absorption of heat from the sun into the atmosphere of the earth." },
            { q: "What are the specific climate changes our world is currently experiencing?", a: "Higher temperatures, increased frequency of storms and natural disasters, more extreme winter weather, increased ocean temperatures and rising ocean levels due to ice melting, decreased biodiversity." },
            { q: "What is a glacial period?", a: "Changes in earth's orbit over time dictate how much solar energy the earth receives from the sun. This dictates cycles of warming and cooling that influence the melting and formation of glaciers." },
            { q: "What is an atom made up of?", a: "Electrons, Protons, and Neutrons." }
        ];

        // State
        let currentCard = 0;
        let cards = [...flashcards];
        let quizCards = [];
        let quizIndex = 0;
        let correctCount = 0;
        let wrongCount = 0;
        let answered = false;

        // DOM Elements
        const flashcard = document.getElementById('flashcard');
        const cardQuestion = document.getElementById('card-question');
        const cardAnswer = document.getElementById('card-answer');
        const cardProgress = document.getElementById('card-progress');
        const progressFill = document.getElementById('progress-fill');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const shuffleBtn = document.getElementById('shuffle-btn');

        const quizQuestionText = document.getElementById('quiz-question-text');
        const quizAnswer = document.getElementById('quiz-answer');
        const quizCurrent = document.getElementById('quiz-current');
        const quizTotal = document.getElementById('quiz-total');
        const correctCountEl = document.getElementById('correct-count');
        const wrongCountEl = document.getElementById('wrong-count');
        const feedback = document.getElementById('feedback');
        const feedbackTitle = document.getElementById('feedback-title');
        const feedbackText = document.getElementById('feedback-text');
        const correctAnswerBox = document.getElementById('correct-answer-box');
        const checkAnswerBtn = document.getElementById('check-answer-btn');
        const showAnswerBtn = document.getElementById('show-answer-btn');
        const nextQuestionBtn = document.getElementById('next-question-btn');
        const quizContent = document.getElementById('quiz-content');
        const quizComplete = document.getElementById('quiz-complete');
        const restartQuizBtn = document.getElementById('restart-quiz-btn');

        const cardGrid = document.getElementById('card-grid');

        // Navigation
        document.querySelectorAll('.nav-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');

                const mode = btn.dataset.mode;
                document.getElementById('study-mode').style.display = mode === 'study' ? 'block' : 'none';
                document.getElementById('quiz-mode').style.display = mode === 'quiz' ? 'block' : 'none';
                document.getElementById('browse-mode').style.display = mode === 'browse' ? 'block' : 'none';
                document.getElementById('quizlet-mode').style.display = mode === 'quizlet' ? 'block' : 'none';

                if (mode === 'quiz') initQuiz();
                if (mode === 'browse') renderBrowse();
            });
        });

        // Study Mode Functions
        function updateCard() {
            cardQuestion.textContent = cards[currentCard].q;
            cardAnswer.textContent = cards[currentCard].a;
            cardProgress.textContent = `${currentCard + 1} of ${cards.length}`;
            progressFill.style.width = `${((currentCard + 1) / cards.length) * 100}%`;
            flashcard.classList.remove('flipped');
        }

        flashcard.addEventListener('click', () => {
            flashcard.classList.toggle('flipped');
        });

        prevBtn.addEventListener('click', () => {
            currentCard = (currentCard - 1 + cards.length) % cards.length;
            updateCard();
        });

        nextBtn.addEventListener('click', () => {
            currentCard = (currentCard + 1) % cards.length;
            updateCard();
        });

        shuffleBtn.addEventListener('click', () => {
            cards = [...cards].sort(() => Math.random() - 0.5);
            currentCard = 0;
            updateCard();
        });

        // Keyboard Navigation
        document.addEventListener('keydown', (e) => {
            const studyMode = document.getElementById('study-mode');
            if (studyMode.style.display !== 'none') {
                if (e.code === 'Space') {
                    e.preventDefault();
                    flashcard.classList.toggle('flipped');
                } else if (e.code === 'ArrowLeft') {
                    prevBtn.click();
                } else if (e.code === 'ArrowRight') {
                    nextBtn.click();
                }
            }
        });

        // Quiz Mode Functions
        function updateAiIndicator() {
            const indicator = document.getElementById('ai-indicator');
            const status = document.getElementById('ai-status');
            if (geminiApiKey) {
                indicator.classList.add('active');
                status.textContent = 'AI Checking';
            } else {
                indicator.classList.remove('active');
                status.textContent = 'Basic Mode';
            }
        }

        function initQuiz() {
            quizCards = [...flashcards].sort(() => Math.random() - 0.5);
            quizIndex = 0;
            correctCount = 0;
            wrongCount = 0;
            answered = false;
            quizContent.style.display = 'block';
            quizComplete.classList.remove('show');
            updateAiIndicator();
            updateQuiz();
        }

        function updateQuiz() {
            quizQuestionText.textContent = quizCards[quizIndex].q;
            quizCurrent.textContent = quizIndex + 1;
            quizTotal.textContent = quizCards.length;
            correctCountEl.textContent = correctCount;
            wrongCountEl.textContent = wrongCount;
            quizAnswer.value = '';
            quizAnswer.disabled = false;
            feedback.className = 'feedback';
            checkAnswerBtn.style.display = 'inline-block';
            showAnswerBtn.style.display = 'inline-block';
            nextQuestionBtn.style.display = 'none';
            answered = false;
            quizAnswer.focus();
        }

        let geminiApiKey = localStorage.getItem('gemini_api_key') || '';

        function showApiKeyPrompt() {
            const key = prompt('Enter your Gemini API Key to enable AI-powered answer checking:\n\n(Get one free at https://aistudio.google.com/app/apikey)');
            if (key && key.trim()) {
                geminiApiKey = key.trim();
                localStorage.setItem('gemini_api_key', geminiApiKey);
                return true;
            }
            return false;
        }

        async function checkAnswerWithGemini(question, correctAnswer, userAnswer) {
            const prompt = `You are a science teacher grading a student's answer. Be encouraging but accurate.

Question: ${question}

Correct Answer: ${correctAnswer}

Student's Answer: ${userAnswer}

Evaluate if the student's answer is correct. The student doesn't need to match word-for-word, but should demonstrate understanding of the key concepts.

Respond in this exact JSON format only, no other text:
{"correct": true/false, "explanation": "Brief explanation of why the answer is correct or what was missing/wrong"}`;

            const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${geminiApiKey}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    contents: [{
                        parts: [{ text: prompt }]
                    }],
                    generationConfig: {
                        temperature: 0.3,
                        maxOutputTokens: 256
                    }
                })
            });

            if (!response.ok) {
                throw new Error('API request failed');
            }

            const data = await response.json();
            const text = data.candidates[0].content.parts[0].text;

            // Parse JSON from response (handle potential markdown code blocks)
            const jsonMatch = text.match(/\{[\s\S]*\}/);
            if (jsonMatch) {
                return JSON.parse(jsonMatch[0]);
            }
            throw new Error('Invalid response format');
        }

        async function checkAnswer() {
            if (answered) return;

            const userAnswer = quizAnswer.value.trim();

            if (!userAnswer) {
                alert('Please enter an answer first!');
                return;
            }

            if (!geminiApiKey) {
                if (!showApiKeyPrompt()) {
                    // Fall back to basic checking if no API key
                    fallbackCheck();
                    return;
                }
            }

            // Show loading state
            checkAnswerBtn.disabled = true;
            checkAnswerBtn.textContent = 'Checking...';
            showAnswerBtn.disabled = true;

            try {
                const result = await checkAnswerWithGemini(
                    quizCards[quizIndex].q,
                    quizCards[quizIndex].a,
                    userAnswer
                );
                showFeedback(result.correct, result.explanation);
            } catch (error) {
                console.error('Gemini API error:', error);
                // If API fails, offer to re-enter key or use fallback
                if (confirm('AI check failed. Would you like to enter a new API key?\n\nClick Cancel to use basic checking instead.')) {
                    localStorage.removeItem('gemini_api_key');
                    geminiApiKey = '';
                    checkAnswerBtn.disabled = false;
                    checkAnswerBtn.textContent = 'Check Answer';
                    showAnswerBtn.disabled = false;
                    checkAnswer();
                } else {
                    fallbackCheck();
                }
            }
        }

        function fallbackCheck() {
            const userAnswer = quizAnswer.value.toLowerCase().trim();
            const correctAnswer = quizCards[quizIndex].a.toLowerCase();

            const userWords = userAnswer.split(/\s+/).filter(w => w.length > 3);
            const correctWords = correctAnswer.split(/\s+/).filter(w => w.length > 3);

            let matchCount = 0;
            userWords.forEach(word => {
                if (correctWords.some(cw => cw.includes(word) || word.includes(cw))) {
                    matchCount++;
                }
            });

            const matchRatio = correctWords.length > 0 ? matchCount / correctWords.length : 0;
            const isCorrect = matchRatio >= 0.4;

            showFeedback(isCorrect, isCorrect ?
                'Your answer covers the key concepts!' :
                'Your answer was missing some key concepts. Compare with the correct answer below.');
        }

        function showFeedback(isCorrect, explanation = '') {
            answered = true;
            quizAnswer.disabled = true;
            checkAnswerBtn.disabled = false;
            checkAnswerBtn.textContent = 'Check Answer';
            showAnswerBtn.disabled = false;

            if (isCorrect) {
                correctCount++;
                feedback.className = 'feedback correct';
                feedbackTitle.textContent = '‚úì Correct!';
                feedbackText.textContent = explanation || 'Great job!';
            } else {
                wrongCount++;
                feedback.className = 'feedback wrong';
                feedbackTitle.textContent = '‚úó Not quite';
                feedbackText.textContent = explanation || 'The correct answer is:';
            }

            correctAnswerBox.innerHTML = '<strong>Correct answer:</strong><br>' + quizCards[quizIndex].a;
            correctCountEl.textContent = correctCount;
            wrongCountEl.textContent = wrongCount;

            checkAnswerBtn.style.display = 'none';
            showAnswerBtn.style.display = 'none';
            nextQuestionBtn.style.display = 'inline-block';
        }

        function showAnswer() {
            showFeedback(false, "You chose to reveal the answer. Study this one and try again next time!");
        }

        function nextQuestion() {
            quizIndex++;
            if (quizIndex >= quizCards.length) {
                showComplete();
            } else {
                updateQuiz();
            }
        }

        function showComplete() {
            quizContent.style.display = 'none';
            quizComplete.classList.add('show');
            document.getElementById('final-correct').textContent = correctCount;
            document.getElementById('final-wrong').textContent = wrongCount;
            document.getElementById('final-percentage').textContent = Math.round((correctCount / quizCards.length) * 100) + '%';
        }

        checkAnswerBtn.addEventListener('click', checkAnswer);
        showAnswerBtn.addEventListener('click', showAnswer);
        nextQuestionBtn.addEventListener('click', nextQuestion);
        restartQuizBtn.addEventListener('click', initQuiz);

        quizAnswer.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                if (!answered) {
                    checkAnswer();
                } else {
                    nextQuestion();
                }
            }
        });

        // Browse Mode Functions
        function renderBrowse() {
            cardGrid.innerHTML = flashcards.map((card, i) => `
                <div class="browse-card">
                    <span class="card-number">${i + 1}</span>
                    <div class="browse-question">${card.q}</div>
                    <div class="browse-answer">${card.a}</div>
                </div>
            `).join('');
        }

        // Quizlet Mode Functions
        document.querySelectorAll('[data-quizlet-mode]').forEach(btn => {
            btn.addEventListener('click', () => {
                // Update active state of buttons
                document.querySelectorAll('[data-quizlet-mode]').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');

                // Update iframe source
                const mode = btn.dataset.quizletMode;
                const iframe = document.getElementById('quizlet-iframe');
                iframe.src = `https://quizlet.com/1118236469/${mode}/embed?i=6rud4j&x=1jj1`;
            });
        });

        // API Key Button
        const apiKeyBtn = document.getElementById('api-key-btn');
        if (apiKeyBtn) {
            apiKeyBtn.addEventListener('click', () => {
                const currentKey = geminiApiKey ? '(key is set)' : '(no key set)';
                const key = prompt(`Enter your Gemini API Key for AI-powered answer checking.\n\nCurrent status: ${currentKey}\n\nGet a free key at: https://aistudio.google.com/app/apikey\n\nLeave blank and click OK to clear the existing key.`);

                if (key === null) return; // User clicked cancel

                if (key.trim()) {
                    geminiApiKey = key.trim();
                    localStorage.setItem('gemini_api_key', geminiApiKey);
                    alert('API key saved! AI-powered checking is now enabled.');
                } else {
                    geminiApiKey = '';
                    localStorage.removeItem('gemini_api_key');
                    alert('API key cleared. Basic checking will be used.');
                }
                updateAiIndicator();
            });
        }

        // Initialize
        updateCard();
    </script>
</body>

</html>
